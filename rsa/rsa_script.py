#!/usr/bin/env python3

import signal
import sys
import struct
import os.path
from time import sleep

from serial import Serial, SerialException

def main():

    sha256 = bytearray([0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0x10,
        0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0x10,
        0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0x10,
        0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0x10,
        0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0x10,
        0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0x10,
        0x1, 0x2, 0x3, 0x4])

    try:
        s = Serial(port='/dev/ttyACM0', baudrate=115200, bytesize=8, parity='N', stopbits=1, timeout=None, xonxoff=0, rtscts=0)
    except SerialException:
        print("can't open serial port")
        exit()

    s.write(sha256)
    s.write(str.encode("ronaldo\x00"))

    status = s.readline().decode()
    print(status)

    if (status == "CORRECT PASSPHRASE"):
        print("Encrypted sha256:", s.readline())
main()
